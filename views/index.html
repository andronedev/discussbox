<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>chat</title>
    <script src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>
    <script src="https://unpkg.com/vue@next"></script>
  </head>

  <body>
    <h1>Hello</h1>
    <div id="app">
       <div class="card-body">
              <div class="messages" v-for="(msg, index) in messages" :key="index">
                  <p><span class="font-weight-bold">{{ msg.user }}: </span>{{ msg.message }}</p>
              </div>
          </div>
    </div>

    <script>
       const app = {
          el: '#app',

      data() {
          return {
              user: '',
              message: '',
              messages: [],
              socket : io()
          }
      },
      methods: {
          sendMessage(e) {
              e.preventDefault();

              this.socket.emit('SEND_MESSAGE', {
                  user: this.user,
                  message: this.message
              });
              this.message = ''
          }
      },
      mounted() {
          this.socket.on('MESSAGE', (data) => {
              this.messages = [...this.messages, data];
              // you can also do this.messages.push(data)
          });
      }

        }

        Vue.createApp(app).mount('#app')
    </script>

    <!-- FIN CODE SOCKET -->
  </body>
</html>
